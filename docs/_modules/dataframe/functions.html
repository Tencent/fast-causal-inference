<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dataframe.functions &mdash; Fast-Causal-Inference  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Fast-Causal-Inference
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../input-output.html">Input/output</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dataframe.html">Dataframe Operations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../inference.html">Causal Inference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Fast-Causal-Inference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">dataframe.functions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for dataframe.functions</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">fast_causal_inference.dataframe</span> <span class="kn">import</span> <span class="n">ais_dataframe_pb2</span> <span class="k">as</span> <span class="n">DfPb</span>
<span class="kn">from</span> <span class="nn">fast_causal_inference.dataframe.df_base</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DfColumnInternalNode</span><span class="p">,</span>
    <span class="n">DfColumnLeafNode</span><span class="p">,</span>
    <span class="n">aggregrate</span><span class="p">,</span>
    <span class="n">register_fn</span><span class="p">,</span>
    <span class="n">OlapEngineType</span><span class="p">,</span>
    <span class="n">define_args</span><span class="p">,</span>
    <span class="n">DfFunction</span><span class="p">,</span>
    <span class="n">DfColumnNode</span><span class="p">,</span>
    <span class="n">FnArg</span><span class="p">,</span>
    <span class="n">DfContext</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">DfFnColWrapper</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">DfFunction</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DfColumnNode</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fn</span> <span class="o">=</span> <span class="n">fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fn</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_params</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span>

    <span class="k">def</span> <span class="nf">has_agg_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fn</span><span class="o">.</span><span class="n">is_agg_func</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">DfFnColWrapper</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span><span class="o">.</span><span class="n">has_agg_func</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias_</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fn</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="n">alias_</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">add</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">subtract</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">multiply</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">divide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">divide</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">modulo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">modulo</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">AddDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; + &quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>


<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AddDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">SubtractDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>


<span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">SubtractDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">MultiplyDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; * &quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>


<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">MultiplyDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">DivideDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; / &quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>


<span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">DivideDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">ModuloDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; % &quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>


<span class="k">def</span> <span class="nf">modulo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">ModuloDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;self&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">SelfRefDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>


<span class="k">def</span> <span class="nf">col</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of columns(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="si">}</span><span class="s2">) is not 1.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">SelfRefDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="n">cols</span><span class="p">)</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LitDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">column</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">DfColumnLeafNode</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">DfColumnInternalNode</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Logical Error: col can only be DfColumnLeafNode|DfColumnInternalNode.&quot;</span>
            <span class="p">)</span>


<div class="viewcode-block" id="lit"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.lit">[docs]</a><span class="k">def</span> <span class="nf">lit</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    lit is used to create a constant column.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;constant&#39;, Fn.lit(1))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of columns(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="si">}</span><span class="s2">) is not 1.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LitDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="n">cols</span><span class="p">)</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggAnyDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="any"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.any">[docs]</a><span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    any is used to aggregate a column with any value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggAnyDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stddevPop&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stddev_pop&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggStddevPopDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="stddevPop"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.stddevPop">[docs]</a><span class="k">def</span> <span class="nf">stddevPop</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    stddevPop is used to calculate the population standard deviation of a column.</span>

<span class="sd">     Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.stddevPop(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).stddevPop(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.stddevPop(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg({&#39;numerator&#39;:&#39;stddevPop&#39;, &#39;numerator_pre&#39;:&#39;stddevPop&#39;}).show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggStddevPopDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stddevSamp&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stddev_samp&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggStddevSampDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="stddevSamp"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.stddevSamp">[docs]</a><span class="k">def</span> <span class="nf">stddevSamp</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    stddevSamp is used to calculate the sample standard deviation of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.stddevSamp(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).stddevSamp(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.stddevSamp(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg({&#39;numerator&#39;:&#39;stddevSamp&#39;, &#39;numerator_pre&#39;:&#39;stddevSamp&#39;}).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggStddevSampDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;varPop&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;var_pop&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggVarPopDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="varPop"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.varPop">[docs]</a><span class="k">def</span> <span class="nf">varPop</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    varPop is used to calculate the population variance of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.varPop(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.varPop(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).varPop(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg({&#39;numerator&#39;:&#39;varPop&#39;, &#39;numerator_pre&#39;:&#39;varPop&#39;}).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggVarPopDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;varSamp&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;var_samp&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggVarSampDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="varSamp"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.varSamp">[docs]</a><span class="k">def</span> <span class="nf">varSamp</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    varSamp is used to calculate the sample variance of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.varSamp(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.varSamp(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).varSamp(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg({&#39;numerator&#39;:&#39;varSamp&#39;, &#39;numerator_pre&#39;:&#39;varSamp&#39;}).show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggVarSampDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;corr&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;corr&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggCorrDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="corr"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.corr">[docs]</a><span class="k">def</span> <span class="nf">corr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    corr is used to calculate the correlation between two columns.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.corr(&#39;numerator&#39;, &#39;numerator_pre&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.corr(&#39;numerator&#39;, &#39;numerator_pre&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).corr(&#39;numerator&#39;, &#39;numerator_pre&#39;).show()</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggCorrDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">is_param</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggCountDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="count"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.count">[docs]</a><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    count is used to count the number of rows.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.count().show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).count().show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.count().alias(&#39;numerator&#39;)).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggCountDfFunction</span><span class="p">(),</span> <span class="p">{</span><span class="s2">&quot;expr&quot;</span><span class="p">:</span> <span class="n">expr</span><span class="p">},</span> <span class="p">[])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;lhs&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;rhs&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">MaxDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggMaxDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="max"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.max">[docs]</a><span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    max is used to calculate the maximum value of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.max(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).max(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.max(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggMaxDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="n">cols</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">MaxDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="n">cols</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of columns(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="si">}</span><span class="s2">) is neither 1 nor 2.&quot;</span><span class="p">)</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;lhs&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;rhs&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">MinDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggMinDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="min"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.min">[docs]</a><span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    min is used to calculate the minimum value of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.min(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).min(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.min(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggMinDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="n">cols</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">MinDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="n">cols</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of columns(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="si">}</span><span class="s2">) is neither 1 nor 2.&quot;</span><span class="p">)</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;avg&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;avg&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggAvgDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="avg"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.avg">[docs]</a><span class="k">def</span> <span class="nf">avg</span><span class="p">(</span><span class="n">col1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    avg is used to calculate the average value of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.avg(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).avg(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.avg(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggAvgDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col1</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggSumDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="sum"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.sum">[docs]</a><span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="n">col1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    sum is used to calculate the sum of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.sum(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).sum(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.sum(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggSumDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col1</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggMeanDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="mean"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.mean">[docs]</a><span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="n">col1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    mean is used to calculate the mean of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.mean(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).mean(&#39;numerator&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.mean(&#39;numerator&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggMeanDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col1</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;quantile&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;percentile_disc&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="n">is_param</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggQuantileDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_starrocks</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_name</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">)&quot;</span>


<div class="viewcode-block" id="quantile"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.quantile">[docs]</a><span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    quantile is used to calculate the quantile of a column.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.quantile(&#39;numerator&#39;, level=0.5).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).quantile(&#39;numerator&#39;, level=0.5).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.quantile(&#39;numerator&#39;, level=0.5).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggQuantileDfFunction</span><span class="p">(),</span> <span class="p">{</span><span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="n">level</span><span class="p">},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;covarPop&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggCovarPopDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="covarPop"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.covarPop">[docs]</a><span class="k">def</span> <span class="nf">covarPop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    covarPop is used to calculate the population covariance between two columns.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.covarPop(&#39;numerator&#39;, &#39;numerator_pre&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.covarPop(&#39;numerator&#39;, &#39;numerator_pre&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).covarPop(&#39;numerator&#39;, &#39;numerator_pre&#39;).show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggCovarPopDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;covarSamp&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggCovarSampDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="covarSamp"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.covarSamp">[docs]</a><span class="k">def</span> <span class="nf">covarSamp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    covarSamp is used to calculate the sample covariance between two columns.</span>

<span class="sd">    Example:</span>
<span class="sd">    ----------</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">        df = fast_causal_inference.readClickHouse(&#39;test_data_small&#39;)</span>
<span class="sd">        df.covarSamp(&#39;numerator&#39;, &#39;numerator_pre&#39;).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).agg(Fn.covarSamp(&#39;numerator&#39;, &#39;numerator_pre&#39;).alias(&#39;numerator&#39;)).show()</span>
<span class="sd">        df.groupBy(&#39;treatment&#39;).covarSamp(&#39;numerator&#39;, &#39;numerator_pre&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggCovarSampDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;anyLast&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggAnyLastDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">anyLast</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggAnyLastDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;anyMin&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggAnyMinDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">anyMin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="c1"># anyMin is used to calculate the minimum value of two columns.</span>

    <span class="c1"># &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
    <span class="c1"># &gt;&gt;&gt; df.anyMin(&#39;x1&#39;, &#39;x2&#39;).show()</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggAnyMinDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;anyMax&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="nd">@aggregrate</span>
<span class="k">class</span> <span class="nc">AggAnyMaxDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">anyMax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="c1"># anyMax is used to calculate the maximum value of two columns.</span>

    <span class="c1"># &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
    <span class="c1"># &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.anyMax(&#39;x1&#39;, &#39;x2&#39;))</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AggAnyMaxDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sqrt&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">SqrtDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="sqrt"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.sqrt">[docs]</a><span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    sqrt is used to calculate the square root of a column.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.sqrt(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">SqrtDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">If somehow we need to bypass Calcite, you need to implement the function `sql_impl_{engine}`</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># basic functions</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;abs&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;abs&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">AbsDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="abs"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.abs">[docs]</a><span class="k">def</span> <span class="nf">abs</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    abs is used to calculate the absolute value of a column.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.abs(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AbsDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">col</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mod&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mod&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">ModDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="mod"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.mod">[docs]</a><span class="k">def</span> <span class="nf">mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    mod is used to calculate the modulo of column x by y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.mod(&#39;weight&#39;, 2))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">ModDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;floor&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;floor&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">FloorDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="floor"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.floor">[docs]</a><span class="k">def</span> <span class="nf">floor</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    floor is used to calculate the largest integer less than or equal to the column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.floor(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">FloorDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ceil&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ceil&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">CeilDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="ceil"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.ceil">[docs]</a><span class="k">def</span> <span class="nf">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ceil is used to calculate the smallest integer greater than or equal to the column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.ceil(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">CeilDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rand&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rand&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">RandDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="rand"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.rand">[docs]</a><span class="k">def</span> <span class="nf">rand</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    rand is used to generate a random number.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.rand())</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">RandDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pow&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pow&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">PowDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="pow"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.pow">[docs]</a><span class="k">def</span> <span class="nf">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pow is used to calculate the column x raised to the power y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.pow(&#39;weight&#39;, 2))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">PowDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">PowerDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="power"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.power">[docs]</a><span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    power is used to calculate the column x raised to the power y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.power(&#39;weight&#39;, 2))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">PowerDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;exp&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;exp&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">ExpDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="exp"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.exp">[docs]</a><span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    exp is used to calculate e raised to the power of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.exp(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">ExpDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LogDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    log is used to calculate the natural logarithm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.log(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LogDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">base</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ln&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ln&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LnDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="ln"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.ln">[docs]</a><span class="k">def</span> <span class="nf">ln</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ln is used to calculate the natural logarithm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.ln(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LnDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<div class="viewcode-block" id="log"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.log">[docs]</a><span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    log is used to calculate the natural logarithm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.log(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LnDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;exp2&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">Exp2DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="exp2"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.exp2">[docs]</a><span class="k">def</span> <span class="nf">exp2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    exp2 is used to calculate 2 raised to the power of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.exp2(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">Exp2DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;log2&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">Log2DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="log2"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.log2">[docs]</a><span class="k">def</span> <span class="nf">log2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    log2 is used to calculate the base 2 logarithm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.log2(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">Log2DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;murmurHash3_64&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">MurmurHash3_64DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="murmur_hash3_64"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.murmur_hash3_64">[docs]</a><span class="k">def</span> <span class="nf">murmur_hash3_64</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    murmur_hash3_64 is used to calculate the murmur3 hash of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.murmur_hash3_64(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">MurmurHash3_64DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;murmurHash3_32&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;murmur_hash3_32&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">MurmurHash3_32DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="murmur_hash3_32"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.murmur_hash3_32">[docs]</a><span class="k">def</span> <span class="nf">murmur_hash3_32</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    murmur_hash3_32 is used to calculate the murmur3 hash of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.murmur_hash3_32(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">MurmurHash3_32DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;isNull&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;isnull&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">IsNullDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="isnull"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.isnull">[docs]</a><span class="k">def</span> <span class="nf">isnull</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    isnull is used to check if column x is null.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.isnull(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">IsNullDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;isNotNull&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;isnotnull&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">IsNotNullDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="isnotnull"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.isnotnull">[docs]</a><span class="k">def</span> <span class="nf">isnotnull</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    isnotnull is used to check if column x is not null.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.isnotnull(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">IsNotNullDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">RoundDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">sql_impl_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">DfContext</span><span class="p">,</span>
        <span class="n">fn_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">fn_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FnArg</span><span class="p">],</span>
        <span class="n">arg_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_name</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn_name</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>


<div class="viewcode-block" id="round"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.round">[docs]</a><span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    round is used to round column x to y decimal places.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.round(&#39;weight&#39;, 2))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">RoundDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cbrt&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">CBRTDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="cbrt"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.cbrt">[docs]</a><span class="k">def</span> <span class="nf">cbrt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cbrt is used to calculate the cube root of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.cbrt(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">CBRTDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;erf&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">ERFDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="erf"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.erf">[docs]</a><span class="k">def</span> <span class="nf">erf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    erf is used to calculate the error function of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.erf(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">ERFDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;erfc&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">ERFCDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="erfc"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.erfc">[docs]</a><span class="k">def</span> <span class="nf">erfc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    erfc is used to calculate the complementary error function of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.erfc(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">ERFCDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lgamma&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LGammaDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="lgamma"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.lgamma">[docs]</a><span class="k">def</span> <span class="nf">lgamma</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    lgamma is used to calculate the log gamma function of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.lgamma(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LGammaDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tgamma&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">TGammaDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="tgamma"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.tgamma">[docs]</a><span class="k">def</span> <span class="nf">tgamma</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    tgamma is used to calculate the gamma function of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.tgamma(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">TGammaDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sin&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sin&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">SinDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="sin"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.sin">[docs]</a><span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    sin is used to calculate the sine of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.sin(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">SinDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cos&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cos&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">CosDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="cos"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.cos">[docs]</a><span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cos is used to calculate the cosine of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.cos(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">CosDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tan&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tan&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">TanDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="tan"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.tan">[docs]</a><span class="k">def</span> <span class="nf">tan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    tan is used to calculate the tangent of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.tan(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">TanDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;asin&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;asin&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">AsinDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="asin"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.asin">[docs]</a><span class="k">def</span> <span class="nf">asin</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    asin is used to calculate the arcsine of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.asin(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AsinDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;acos&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;acos&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">AcosDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="acos"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.acos">[docs]</a><span class="k">def</span> <span class="nf">acos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    acos is used to calculate the arccosine of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.acos(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AcosDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;atan&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;atan&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">AtanDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="atan"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.atan">[docs]</a><span class="k">def</span> <span class="nf">atan</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    atan is used to calculate the arctangent of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.atan(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">AtanDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;exp10&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">Exp10DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="exp10"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.exp10">[docs]</a><span class="k">def</span> <span class="nf">exp10</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    exp10 is used to calculate 10 raised to the power of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.exp10(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">Exp10DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;log10&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">Log10DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="log10"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.log10">[docs]</a><span class="k">def</span> <span class="nf">log10</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    log10 is used to calculate the base 10 logarithm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.log10(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">Log10DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;intExp2&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">IntExp2DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="intExp2"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.intExp2">[docs]</a><span class="k">def</span> <span class="nf">intExp2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    intExp2 is used to calculate 2 raised to the power of column x, and the result is an integer.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.intExp2(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">IntExp2DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;intExp10&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">IntExp10DfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="intExp10"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.intExp10">[docs]</a><span class="k">def</span> <span class="nf">intExp10</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    intExp10 is used to calculate 10 raised to the power of column x, and the result is an integer.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.intExp10(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">IntExp10DfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gcd&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">GCDDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="gcd"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.gcd">[docs]</a><span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    gcd is used to calculate the greatest common divisor of column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.gcd(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">GCDDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lcm&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LCMDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="lcm"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.lcm">[docs]</a><span class="k">def</span> <span class="nf">lcm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    lcm is used to calculate the least common multiple of column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.lcm(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LCMDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;If&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;if&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;cond&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">IfDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="If"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.If">[docs]</a><span class="k">def</span> <span class="nf">If</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If is used to create a new column based on the condition x. If x is true, y is returned, otherwise z is returned.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.If(df[&#39;weight&#39;] &gt; 0.5, &#39;&gt;0.5&#39;, &#39;&lt;0.5&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.If(&#39;weight&gt;0.5&#39;, 1, 0))</span>
<span class="sd">    &gt;&gt;&gt; df_new.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">IfDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">ConstantEDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="e"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.e">[docs]</a><span class="k">def</span> <span class="nf">e</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    e is used to get the mathematical constant e.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.e())</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">ConstantEDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pi&quot;</span><span class="p">)</span>
<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">STARROCKS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pi&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">ConstantPiDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="pi"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.pi">[docs]</a><span class="k">def</span> <span class="nf">pi</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pi is used to get the mathematical constant pi.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.pi())</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">ConstantPiDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;L1Norm&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">L1NormDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="L1Norm"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.L1Norm">[docs]</a><span class="k">def</span> <span class="nf">L1Norm</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    L1Norm is used to calculate the L1 norm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.L1Norm(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">L1NormDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;L2Norm&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">L2NormDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="L2Norm"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.L2Norm">[docs]</a><span class="k">def</span> <span class="nf">L2Norm</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    L2Norm is used to calculate the L2 norm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.L2Norm(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">L2NormDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LinfNorm&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LinfNormDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="LinfNorm"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.LinfNorm">[docs]</a><span class="k">def</span> <span class="nf">LinfNorm</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LinfNorm is used to calculate the L-infinity norm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.LinfNorm(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LinfNormDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LpNorm&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LpNormDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="LpNorm"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.LpNorm">[docs]</a><span class="k">def</span> <span class="nf">LpNorm</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LpNorm is used to calculate the Lp norm of column x.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.LpNorm(&#39;weight&#39;, 2))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LpNormDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;L1Distance&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">L1DistanceDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="L1Distance"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.L1Distance">[docs]</a><span class="k">def</span> <span class="nf">L1Distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    L1Distance is used to calculate the L1 distance between column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.L1Distance(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">L1DistanceDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;L2Distance&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">L2DistanceDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="L2Distance"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.L2Distance">[docs]</a><span class="k">def</span> <span class="nf">L2Distance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    L2Distance is used to calculate the L2 distance between column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.L2Distance(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">L2DistanceDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;L2SquaredDistance&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">L2SquaredDistanceDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="L2SquaredDistance"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.L2SquaredDistance">[docs]</a><span class="k">def</span> <span class="nf">L2SquaredDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    L2SquaredDistance is used to calculate the squared L2 distance between column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.L2SquaredDistance(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">L2SquaredDistanceDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LinfDistance&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LinfDistanceDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="LinfDistance"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.LinfDistance">[docs]</a><span class="k">def</span> <span class="nf">LinfDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LinfDistance is used to calculate the L-infinity distance between column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.LinfDistance(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LinfDistanceDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LpDistance&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LpDistanceDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="LpDistance"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.LpDistance">[docs]</a><span class="k">def</span> <span class="nf">LpDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LpDistance is used to calculate the Lp distance between column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.LpDistance(&#39;weight&#39;, &#39;height&#39;, 2))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LpDistanceDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;L1Normalize&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">L1NormalizeDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="L1Normalize"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.L1Normalize">[docs]</a><span class="k">def</span> <span class="nf">L1Normalize</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    L1Normalize is used to normalize column x using L1 norm.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.L1Normalize(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">L1NormalizeDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;L2Normalize&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">L2NormalizeDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="L2Normalize"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.L2Normalize">[docs]</a><span class="k">def</span> <span class="nf">L2Normalize</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    L2Normalize is used to normalize column x using L2 norm.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.L2Normalize(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">L2NormalizeDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LinfNormalize&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LinfNormalizeDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="LinfNormalize"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.LinfNormalize">[docs]</a><span class="k">def</span> <span class="nf">LinfNormalize</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LinfNormalize is used to normalize column x using L-infinity norm.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.LinfNormalize(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LinfNormalizeDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LpNormalize&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">LpNormalizeDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="LpNormalize"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.LpNormalize">[docs]</a><span class="k">def</span> <span class="nf">LpNormalize</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LpNormalize is used to normalize column x using Lp norm.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.LpNormalize(&#39;weight&#39;, 2))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">LpNormalizeDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cosineDistance&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">cosineDistanceDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="cosineDistance"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.cosineDistance">[docs]</a><span class="k">def</span> <span class="nf">cosineDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cosineDistance is used to calculate the cosine distance between column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.cosineDistance(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">cosineDistanceDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<span class="nd">@register_fn</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">OlapEngineType</span><span class="o">.</span><span class="n">CLICKHOUSE</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cosineSimilarity&quot;</span><span class="p">)</span>
<span class="nd">@define_args</span><span class="p">(</span><span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">FnArg</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">cosineSimilarityDfFunction</span><span class="p">(</span><span class="n">DfFunction</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="cosineSimilarity"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.cosineSimilarity">[docs]</a><span class="k">def</span> <span class="nf">cosineSimilarity</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cosineSimilarity is used to calculate the cosine similarity between column x and y.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.withColumn(&#39;new_column&#39;, Fn.cosineSimilarity(&#39;weight&#39;, &#39;height&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.avg(&#39;new_column&#39;).show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DfFnColWrapper</span><span class="p">(</span><span class="n">cosineSimilarityDfFunction</span><span class="p">(),</span> <span class="p">{},</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span></div>


<div class="viewcode-block" id="desc"><a class="viewcode-back" href="../../dataframe.html#dataframe.functions.desc">[docs]</a><span class="k">def</span> <span class="nf">desc</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    desc is used to sort column x in descending order.</span>

<span class="sd">    &gt;&gt;&gt; import fast_causal_inference.dataframe.functions as Fn</span>
<span class="sd">    &gt;&gt;&gt; df_new = df.orderBy(Fn.desc(&#39;weight&#39;))</span>
<span class="sd">    &gt;&gt;&gt; df_new.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">DfPb</span><span class="o">.</span><span class="n">Order</span><span class="p">()</span>
    <span class="n">order</span><span class="o">.</span><span class="n">column</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">column</span>
    <span class="n">order</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">order</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Tencent.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>