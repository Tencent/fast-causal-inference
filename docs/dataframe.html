<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dataframe Operations &mdash; Fast-Causal-Inference  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Causal Inference" href="inference.html" />
    <link rel="prev" title="dataframe.readStarRocks" href="dataframe/dataframe.readStarRocks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Fast-Causal-Inference
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="input-output.html">Input/output</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dataframe Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dataframe">dataframe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.dataframe.DataFrame"><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.describe"><code class="docutils literal notranslate"><span class="pre">DataFrame.describe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.drop"><code class="docutils literal notranslate"><span class="pre">DataFrame.drop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.filter"><code class="docutils literal notranslate"><span class="pre">DataFrame.filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.first"><code class="docutils literal notranslate"><span class="pre">DataFrame.first()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.groupBy"><code class="docutils literal notranslate"><span class="pre">DataFrame.groupBy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.head"><code class="docutils literal notranslate"><span class="pre">DataFrame.head()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.orderBy"><code class="docutils literal notranslate"><span class="pre">DataFrame.orderBy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.printSchema"><code class="docutils literal notranslate"><span class="pre">DataFrame.printSchema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.sample"><code class="docutils literal notranslate"><span class="pre">DataFrame.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.select"><code class="docutils literal notranslate"><span class="pre">DataFrame.select()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.show"><code class="docutils literal notranslate"><span class="pre">DataFrame.show()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.split"><code class="docutils literal notranslate"><span class="pre">DataFrame.split()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.take"><code class="docutils literal notranslate"><span class="pre">DataFrame.take()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.toClickHouse"><code class="docutils literal notranslate"><span class="pre">DataFrame.toClickHouse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.toCsv"><code class="docutils literal notranslate"><span class="pre">DataFrame.toCsv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.toPandas"><code class="docutils literal notranslate"><span class="pre">DataFrame.toPandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.toSparkDf"><code class="docutils literal notranslate"><span class="pre">DataFrame.toSparkDf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.toTdw"><code class="docutils literal notranslate"><span class="pre">DataFrame.toTdw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.union"><code class="docutils literal notranslate"><span class="pre">DataFrame.union()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.where"><code class="docutils literal notranslate"><span class="pre">DataFrame.where()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.withColumn"><code class="docutils literal notranslate"><span class="pre">DataFrame.withColumn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.dataframe.DataFrame.withColumnRenamed"><code class="docutils literal notranslate"><span class="pre">DataFrame.withColumnRenamed()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#functions">functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.If"><code class="docutils literal notranslate"><span class="pre">If()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.L1Distance"><code class="docutils literal notranslate"><span class="pre">L1Distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.L1Norm"><code class="docutils literal notranslate"><span class="pre">L1Norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.L1Normalize"><code class="docutils literal notranslate"><span class="pre">L1Normalize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.L2Distance"><code class="docutils literal notranslate"><span class="pre">L2Distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.L2Norm"><code class="docutils literal notranslate"><span class="pre">L2Norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.L2Normalize"><code class="docutils literal notranslate"><span class="pre">L2Normalize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.L2SquaredDistance"><code class="docutils literal notranslate"><span class="pre">L2SquaredDistance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.LinfDistance"><code class="docutils literal notranslate"><span class="pre">LinfDistance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.LinfNorm"><code class="docutils literal notranslate"><span class="pre">LinfNorm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.LinfNormalize"><code class="docutils literal notranslate"><span class="pre">LinfNormalize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.LpDistance"><code class="docutils literal notranslate"><span class="pre">LpDistance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.LpNorm"><code class="docutils literal notranslate"><span class="pre">LpNorm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.LpNormalize"><code class="docutils literal notranslate"><span class="pre">LpNormalize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.abs"><code class="docutils literal notranslate"><span class="pre">abs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.acos"><code class="docutils literal notranslate"><span class="pre">acos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.any"><code class="docutils literal notranslate"><span class="pre">any()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.asin"><code class="docutils literal notranslate"><span class="pre">asin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.atan"><code class="docutils literal notranslate"><span class="pre">atan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.avg"><code class="docutils literal notranslate"><span class="pre">avg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.cbrt"><code class="docutils literal notranslate"><span class="pre">cbrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.ceil"><code class="docutils literal notranslate"><span class="pre">ceil()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.corr"><code class="docutils literal notranslate"><span class="pre">corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.cos"><code class="docutils literal notranslate"><span class="pre">cos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.cosineDistance"><code class="docutils literal notranslate"><span class="pre">cosineDistance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.cosineSimilarity"><code class="docutils literal notranslate"><span class="pre">cosineSimilarity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.count"><code class="docutils literal notranslate"><span class="pre">count()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.covarPop"><code class="docutils literal notranslate"><span class="pre">covarPop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.covarSamp"><code class="docutils literal notranslate"><span class="pre">covarSamp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.desc"><code class="docutils literal notranslate"><span class="pre">desc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.e"><code class="docutils literal notranslate"><span class="pre">e()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.erf"><code class="docutils literal notranslate"><span class="pre">erf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.erfc"><code class="docutils literal notranslate"><span class="pre">erfc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.exp"><code class="docutils literal notranslate"><span class="pre">exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.exp10"><code class="docutils literal notranslate"><span class="pre">exp10()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.exp2"><code class="docutils literal notranslate"><span class="pre">exp2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.floor"><code class="docutils literal notranslate"><span class="pre">floor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.intExp10"><code class="docutils literal notranslate"><span class="pre">intExp10()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.intExp2"><code class="docutils literal notranslate"><span class="pre">intExp2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.isnotnull"><code class="docutils literal notranslate"><span class="pre">isnotnull()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.isnull"><code class="docutils literal notranslate"><span class="pre">isnull()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.lcm"><code class="docutils literal notranslate"><span class="pre">lcm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.lgamma"><code class="docutils literal notranslate"><span class="pre">lgamma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.lit"><code class="docutils literal notranslate"><span class="pre">lit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.ln"><code class="docutils literal notranslate"><span class="pre">ln()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.log10"><code class="docutils literal notranslate"><span class="pre">log10()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.log2"><code class="docutils literal notranslate"><span class="pre">log2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.max"><code class="docutils literal notranslate"><span class="pre">max()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.mean"><code class="docutils literal notranslate"><span class="pre">mean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.min"><code class="docutils literal notranslate"><span class="pre">min()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.mod"><code class="docutils literal notranslate"><span class="pre">mod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.murmur_hash3_32"><code class="docutils literal notranslate"><span class="pre">murmur_hash3_32()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.murmur_hash3_64"><code class="docutils literal notranslate"><span class="pre">murmur_hash3_64()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.pi"><code class="docutils literal notranslate"><span class="pre">pi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.pow"><code class="docutils literal notranslate"><span class="pre">pow()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.power"><code class="docutils literal notranslate"><span class="pre">power()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.quantile"><code class="docutils literal notranslate"><span class="pre">quantile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.rand"><code class="docutils literal notranslate"><span class="pre">rand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.round"><code class="docutils literal notranslate"><span class="pre">round()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.sin"><code class="docutils literal notranslate"><span class="pre">sin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.sqrt"><code class="docutils literal notranslate"><span class="pre">sqrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.stddevPop"><code class="docutils literal notranslate"><span class="pre">stddevPop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.stddevSamp"><code class="docutils literal notranslate"><span class="pre">stddevSamp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.sum"><code class="docutils literal notranslate"><span class="pre">sum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.tan"><code class="docutils literal notranslate"><span class="pre">tan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.tgamma"><code class="docutils literal notranslate"><span class="pre">tgamma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.varPop"><code class="docutils literal notranslate"><span class="pre">varPop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.functions.varSamp"><code class="docutils literal notranslate"><span class="pre">varSamp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#features">features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.features.Bucketizer"><code class="docutils literal notranslate"><span class="pre">Bucketizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dataframe.features.Bucketizer.fit"><code class="docutils literal notranslate"><span class="pre">Bucketizer.fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe.features.OneHotEncoder"><code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Causal Inference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Fast-Causal-Inference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Dataframe Operations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dataframe.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dataframe-operations">
<h1>Dataframe Operations<a class="headerlink" href="#dataframe-operations" title="Permalink to this heading"></a></h1>
<section id="dataframe">
<h2>dataframe<a class="headerlink" href="#dataframe" title="Permalink to this heading"></a></h2>
<span class="target" id="dataframe-api"></span><dl class="py class">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dataframe.dataframe.</span></span><span class="sig-name descname"><span class="pre">DataFrame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">olap_engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">OlapEngineType.CLICKHOUSE</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame" title="Permalink to this definition"></a></dt>
<dd><p>This class is used to create a DataFrame object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.describe">
<span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.describe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.describe" title="Permalink to this definition"></a></dt>
<dd><p>Returns the summary statistics for the columns in the DataFrame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">([</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">])</span>
<span class="go">#       count       avg       std       min  quantile_0.25  quantile_0.5  quantile_0.75  quantile_0.90  quantile_0.99      max</span>
<span class="go"># x1  10000.0 -0.018434  0.987606 -3.740101       -0.68929     -0.028665       0.654210       1.274144       2.321097  3.80166</span>
<span class="go"># x2  10000.0  0.021976  1.986209 -8.893264       -1.28461      0.015400       1.357618       2.583523       4.725829  7.19662</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.drop">
<span class="sig-name descname"><span class="pre">drop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.drop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.drop" title="Permalink to this definition"></a></dt>
<dd><p>Drops specified columns from the DataFrame and returns a new DataFrame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.filter" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the ‘where’ function. Filters rows using the given condition.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;column1 &gt; 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.first">
<span class="sig-name descname"><span class="pre">first</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.first"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.first" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to get the first row of the dataframe</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.groupBy">
<span class="sig-name descname"><span class="pre">groupBy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.groupBy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.groupBy" title="Permalink to this definition"></a></dt>
<dd><p>Groups the DataFrame by the specified columns and returns a new DataFrame.Exception: If the DataFrame is already in <cite>need_agg</cite> state.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">([</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.head">
<span class="sig-name descname"><span class="pre">head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.head" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to get the first n rows of the dataframe</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.orderBy">
<span class="sig-name descname"><span class="pre">orderBy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.orderBy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.orderBy" title="Permalink to this definition"></a></dt>
<dd><p>Orders the DataFrame by the specified columns and returns a new DataFrame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s1">&#39;column2&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">orderBy</span><span class="p">([</span><span class="s1">&#39;column1&#39;</span><span class="p">,</span> <span class="s1">&#39;column2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.printSchema">
<span class="sig-name descname"><span class="pre">printSchema</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.printSchema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.printSchema" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to print the schema of the dataframe</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fraction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.sample" title="Permalink to this definition"></a></dt>
<dd><p>This function samples a fraction of rows without replacement from the DataFrame.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.select" title="Permalink to this definition"></a></dt>
<dd><p>Selects specified columns from the DataFrame and returns a new DataFrame.
&gt;&gt;&gt; new_df = df.select(‘column1’, ‘column2’)
&gt;&gt;&gt; new_df = df.select([‘column1’, ‘column2’])</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.show" title="Permalink to this definition"></a></dt>
<dd><p>Prints the DataFrame, equivalent to print(dataframe).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.split" title="Permalink to this definition"></a></dt>
<dd><p>This function splits the DataFrame into two DataFrames.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.take">
<span class="sig-name descname"><span class="pre">take</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.take"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.take" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to get the first n rows of the dataframe</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.toClickHouse">
<span class="sig-name descname"><span class="pre">toClickHouse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clickhouse_table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.toClickHouse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.toClickHouse" title="Permalink to this definition"></a></dt>
<dd><p>ClickHouse table &gt;&gt; ClickHouse table.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">toClickHouse</span><span class="p">(</span><span class="s2">&quot;new_table&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.toCsv">
<span class="sig-name descname"><span class="pre">toCsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file_abs_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.toCsv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.toCsv" title="Permalink to this definition"></a></dt>
<dd><p>Convert the data from ClickHouse table to a CSV file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">toCsv</span><span class="p">(</span><span class="s2">&quot;/path/to/output.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.toPandas">
<span class="sig-name descname"><span class="pre">toPandas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.toPandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.toPandas" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to convert the result of the dataframe to pandas.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.toSparkDf">
<span class="sig-name descname"><span class="pre">toSparkDf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.toSparkDf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.toSparkDf" title="Permalink to this definition"></a></dt>
<dd><p>ClickHouse table &gt;&gt; spark dataframe.</p>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">set_default</span><span class="p">(</span><span class="n">tenant_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">tenant_secret_key</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spark</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">set_spark_session</span><span class="p">(</span><span class="n">group_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">gaia_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c1"># group_id,gaia_id 参考 notebook上默认文件！Spark 资源池.html</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spark_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">toSparkDf</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.toTdw">
<span class="sig-name descname"><span class="pre">toTdw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tdw_database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdw_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdw_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdw_passward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_drop_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priPart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.toTdw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.toTdw" title="Permalink to this definition"></a></dt>
<dd><p>ClickHouse table &gt;&gt; TDW-thive table.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">tdw_database (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the TDW database.</p>
</dd>
<dt class="field-even">tdw_table (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the TDW table.</p>
</dd>
<dt class="field-odd">tdw_user (str, optional)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The username for TDW. Default is None.</p>
</dd>
<dt class="field-even">tdw_passward (str, optional)<span class="colon">:</span></dt>
<dd class="field-even"><p>The password for TDW. Default is None.</p>
</dd>
<dt class="field-odd">group (str, optional)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The group for TDW. Default is ‘tl’.</p>
</dd>
<dt class="field-even">is_drop_table (bool, optional)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to drop the existing TDW table. Default is False.</p>
</dd>
<dt class="field-odd">overwrite (bool, optional)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to overwrite the existing data in the TDW table. Default is True.</p>
</dd>
<dt class="field-even">priPart (str, optional)<span class="colon">:</span></dt>
<dd class="field-even"><p>The primary partition for the TDW table. Default is None.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id2">
<h3>Example<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">toTdw</span><span class="p">(</span><span class="s2">&quot;tdw_database&quot;</span><span class="p">,</span> <span class="s2">&quot;tdw_table&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;tl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">toTdw</span><span class="p">(</span><span class="s2">&quot;tdw_database&quot;</span><span class="p">,</span> <span class="s2">&quot;tdw_table&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;tl&#39;</span><span class="p">,</span><span class="n">priPart</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p_20220222&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.union">
<span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.union" title="Permalink to this definition"></a></dt>
<dd><p>This function is used to union two DataFrames.
The two DataFrames must have the same number of columns, and the columns must have the same names and order.
&gt;&gt;&gt; df1 = df1.union(df2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.where">
<span class="sig-name descname"><span class="pre">where</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.where"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.where" title="Permalink to this definition"></a></dt>
<dd><p>Filters rows using the given condition.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;column1 &gt; 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.withColumn">
<span class="sig-name descname"><span class="pre">withColumn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.withColumn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.withColumn" title="Permalink to this definition"></a></dt>
<dd><p>This function adds a new column to the DataFrame.</p>
<section id="id3">
<h3>Example<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.statistics</span> <span class="k">as</span> <span class="nn">S</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;x3&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator&#39;</span><span class="p">)</span>

<span class="c1"># Method 1: Select columns through df&#39;s index: df[&#39;col&#39;]</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_col&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;numerator&#39;</span><span class="p">]))</span>
<span class="n">df1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Method 2: Select columns directly through string: Fn.col(&#39;new_col&#39;)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_col2&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="s1">&#39;new_col&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">df1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_col3&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;new_col&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">Fn</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;new_col&#39;</span><span class="p">))</span>
<span class="n">df1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Add constant</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;c2&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Nesting</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">))),</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># +-*/% operations</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="mi">22</span> <span class="o">+</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;x3&#39;</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span><span class="p">]))</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;x1 + x2 * x3 + x3&#39;</span><span class="p">))</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># if</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;cc1&#39;</span><span class="p">,</span> <span class="s1">&#39;if(x1 &gt; 0, 1, -1)&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;cc1&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="s1">&#39;x1 &gt; 0&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">df2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dataframe.dataframe.DataFrame.withColumnRenamed">
<span class="sig-name descname"><span class="pre">withColumnRenamed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/dataframe.html#DataFrame.withColumnRenamed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.dataframe.DataFrame.withColumnRenamed" title="Permalink to this definition"></a></dt>
<dd><p>Returns a new DataFrame by renaming an existing column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;column1&quot;</span><span class="p">,</span> <span class="s2">&quot;new_column1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="functions">
<h2>functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h2>
<span class="target" id="module-dataframe.functions"><span id="functions-api"></span></span><dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.If">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">If</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#If"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.If" title="Permalink to this definition"></a></dt>
<dd><p>If is used to create a new column based on the condition x. If x is true, y is returned, otherwise z is returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;&gt;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;0.5&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">If</span><span class="p">(</span><span class="s1">&#39;weight&gt;0.5&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.L1Distance">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">L1Distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#L1Distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.L1Distance" title="Permalink to this definition"></a></dt>
<dd><p>L1Distance is used to calculate the L1 distance between column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">L1Distance</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.L1Norm">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">L1Norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#L1Norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.L1Norm" title="Permalink to this definition"></a></dt>
<dd><p>L1Norm is used to calculate the L1 norm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">L1Norm</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.L1Normalize">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">L1Normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#L1Normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.L1Normalize" title="Permalink to this definition"></a></dt>
<dd><p>L1Normalize is used to normalize column x using L1 norm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">L1Normalize</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.L2Distance">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">L2Distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#L2Distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.L2Distance" title="Permalink to this definition"></a></dt>
<dd><p>L2Distance is used to calculate the L2 distance between column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">L2Distance</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.L2Norm">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">L2Norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#L2Norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.L2Norm" title="Permalink to this definition"></a></dt>
<dd><p>L2Norm is used to calculate the L2 norm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">L2Norm</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.L2Normalize">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">L2Normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#L2Normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.L2Normalize" title="Permalink to this definition"></a></dt>
<dd><p>L2Normalize is used to normalize column x using L2 norm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">L2Normalize</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.L2SquaredDistance">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">L2SquaredDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#L2SquaredDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.L2SquaredDistance" title="Permalink to this definition"></a></dt>
<dd><p>L2SquaredDistance is used to calculate the squared L2 distance between column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">L2SquaredDistance</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.LinfDistance">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">LinfDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#LinfDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.LinfDistance" title="Permalink to this definition"></a></dt>
<dd><p>LinfDistance is used to calculate the L-infinity distance between column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">LinfDistance</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.LinfNorm">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">LinfNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#LinfNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.LinfNorm" title="Permalink to this definition"></a></dt>
<dd><p>LinfNorm is used to calculate the L-infinity norm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">LinfNorm</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.LinfNormalize">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">LinfNormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#LinfNormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.LinfNormalize" title="Permalink to this definition"></a></dt>
<dd><p>LinfNormalize is used to normalize column x using L-infinity norm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">LinfNormalize</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.LpDistance">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">LpDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#LpDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.LpDistance" title="Permalink to this definition"></a></dt>
<dd><p>LpDistance is used to calculate the Lp distance between column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">LpDistance</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.LpNorm">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">LpNorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#LpNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.LpNorm" title="Permalink to this definition"></a></dt>
<dd><p>LpNorm is used to calculate the Lp norm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">LpNorm</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.LpNormalize">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">LpNormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#LpNormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.LpNormalize" title="Permalink to this definition"></a></dt>
<dd><p>LpNormalize is used to normalize column x using Lp norm.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">LpNormalize</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.abs">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#abs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.abs" title="Permalink to this definition"></a></dt>
<dd><p>abs is used to calculate the absolute value of a column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.acos">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">acos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#acos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.acos" title="Permalink to this definition"></a></dt>
<dd><p>acos is used to calculate the arccosine of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.any">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">any</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#any"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.any" title="Permalink to this definition"></a></dt>
<dd><p>any is used to aggregate a column with any value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.asin">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">asin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#asin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.asin" title="Permalink to this definition"></a></dt>
<dd><p>asin is used to calculate the arcsine of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.atan">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">atan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#atan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.atan" title="Permalink to this definition"></a></dt>
<dd><p>atan is used to calculate the arctangent of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.avg">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.avg" title="Permalink to this definition"></a></dt>
<dd><p>avg is used to calculate the average value of a column.</p>
<section id="id4">
<h3>Example:<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.cbrt">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">cbrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#cbrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.cbrt" title="Permalink to this definition"></a></dt>
<dd><p>cbrt is used to calculate the cube root of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">cbrt</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.ceil">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#ceil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.ceil" title="Permalink to this definition"></a></dt>
<dd><p>ceil is used to calculate the smallest integer greater than or equal to the column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.corr">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.corr" title="Permalink to this definition"></a></dt>
<dd><p>corr is used to calculate the correlation between two columns.</p>
<section id="id5">
<h3>Example:<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.cos">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#cos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.cos" title="Permalink to this definition"></a></dt>
<dd><p>cos is used to calculate the cosine of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.cosineDistance">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">cosineDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#cosineDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.cosineDistance" title="Permalink to this definition"></a></dt>
<dd><p>cosineDistance is used to calculate the cosine distance between column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">cosineDistance</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.cosineSimilarity">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">cosineSimilarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#cosineSimilarity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.cosineSimilarity" title="Permalink to this definition"></a></dt>
<dd><p>cosineSimilarity is used to calculate the cosine similarity between column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">cosineSimilarity</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.count">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.count" title="Permalink to this definition"></a></dt>
<dd><p>count is used to count the number of rows.</p>
<section id="id6">
<h3>Example:<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.covarPop">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">covarPop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#covarPop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.covarPop" title="Permalink to this definition"></a></dt>
<dd><p>covarPop is used to calculate the population covariance between two columns.</p>
<section id="id7">
<h3>Example:<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">covarPop</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">covarPop</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">covarPop</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.covarSamp">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">covarSamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#covarSamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.covarSamp" title="Permalink to this definition"></a></dt>
<dd><p>covarSamp is used to calculate the sample covariance between two columns.</p>
<section id="id8">
<h3>Example:<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">covarSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">covarSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">covarSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.desc">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">desc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#desc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.desc" title="Permalink to this definition"></a></dt>
<dd><p>desc is used to sort column x in descending order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.e">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">e</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.e" title="Permalink to this definition"></a></dt>
<dd><p>e is used to get the mathematical constant e.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">e</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.erf">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">erf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#erf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.erf" title="Permalink to this definition"></a></dt>
<dd><p>erf is used to calculate the error function of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.erfc">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">erfc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#erfc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.erfc" title="Permalink to this definition"></a></dt>
<dd><p>erfc is used to calculate the complementary error function of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.exp">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.exp" title="Permalink to this definition"></a></dt>
<dd><p>exp is used to calculate e raised to the power of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.exp10">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">exp10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#exp10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.exp10" title="Permalink to this definition"></a></dt>
<dd><p>exp10 is used to calculate 10 raised to the power of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">exp10</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.exp2">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">exp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#exp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.exp2" title="Permalink to this definition"></a></dt>
<dd><p>exp2 is used to calculate 2 raised to the power of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">exp2</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.floor">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">floor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#floor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.floor" title="Permalink to this definition"></a></dt>
<dd><p>floor is used to calculate the largest integer less than or equal to the column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.gcd">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#gcd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.gcd" title="Permalink to this definition"></a></dt>
<dd><p>gcd is used to calculate the greatest common divisor of column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.intExp10">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">intExp10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#intExp10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.intExp10" title="Permalink to this definition"></a></dt>
<dd><p>intExp10 is used to calculate 10 raised to the power of column x, and the result is an integer.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">intExp10</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.intExp2">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">intExp2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#intExp2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.intExp2" title="Permalink to this definition"></a></dt>
<dd><p>intExp2 is used to calculate 2 raised to the power of column x, and the result is an integer.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">intExp2</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.isnotnull">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">isnotnull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#isnotnull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.isnotnull" title="Permalink to this definition"></a></dt>
<dd><p>isnotnull is used to check if column x is not null.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">isnotnull</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.isnull">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">isnull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#isnull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.isnull" title="Permalink to this definition"></a></dt>
<dd><p>isnull is used to check if column x is null.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.lcm">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">lcm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#lcm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.lcm" title="Permalink to this definition"></a></dt>
<dd><p>lcm is used to calculate the least common multiple of column x and y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.lgamma">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">lgamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#lgamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.lgamma" title="Permalink to this definition"></a></dt>
<dd><p>lgamma is used to calculate the log gamma function of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">lgamma</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.lit">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">lit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#lit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.lit" title="Permalink to this definition"></a></dt>
<dd><p>lit is used to create a constant column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.ln">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">ln</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#ln"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.ln" title="Permalink to this definition"></a></dt>
<dd><p>ln is used to calculate the natural logarithm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.log">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.log" title="Permalink to this definition"></a></dt>
<dd><p>log is used to calculate the natural logarithm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.log10">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">log10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#log10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.log10" title="Permalink to this definition"></a></dt>
<dd><p>log10 is used to calculate the base 10 logarithm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.log2">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">log2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#log2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.log2" title="Permalink to this definition"></a></dt>
<dd><p>log2 is used to calculate the base 2 logarithm of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.max">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.max" title="Permalink to this definition"></a></dt>
<dd><p>max is used to calculate the maximum value of a column.</p>
<section id="id9">
<h3>Example:<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.mean">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.mean" title="Permalink to this definition"></a></dt>
<dd><p>mean is used to calculate the mean of a column.</p>
<section id="id10">
<h3>Example:<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.min">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.min" title="Permalink to this definition"></a></dt>
<dd><p>min is used to calculate the minimum value of a column.</p>
<section id="id11">
<h3>Example:<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.mod">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#mod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.mod" title="Permalink to this definition"></a></dt>
<dd><p>mod is used to calculate the modulo of column x by y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.murmur_hash3_32">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">murmur_hash3_32</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#murmur_hash3_32"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.murmur_hash3_32" title="Permalink to this definition"></a></dt>
<dd><p>murmur_hash3_32 is used to calculate the murmur3 hash of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">murmur_hash3_32</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.murmur_hash3_64">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">murmur_hash3_64</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#murmur_hash3_64"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.murmur_hash3_64" title="Permalink to this definition"></a></dt>
<dd><p>murmur_hash3_64 is used to calculate the murmur3 hash of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">murmur_hash3_64</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.pi">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">pi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#pi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.pi" title="Permalink to this definition"></a></dt>
<dd><p>pi is used to get the mathematical constant pi.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">pi</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.pow">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#pow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.pow" title="Permalink to this definition"></a></dt>
<dd><p>pow is used to calculate the column x raised to the power y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.power">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.power" title="Permalink to this definition"></a></dt>
<dd><p>power is used to calculate the column x raised to the power y.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.quantile">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#quantile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.quantile" title="Permalink to this definition"></a></dt>
<dd><p>quantile is used to calculate the quantile of a column.</p>
<section id="id12">
<h3>Example:<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.rand">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">rand</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#rand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.rand" title="Permalink to this definition"></a></dt>
<dd><p>rand is used to generate a random number.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">rand</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.round">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#round"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.round" title="Permalink to this definition"></a></dt>
<dd><p>round is used to round column x to y decimal places.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.sin">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.sin" title="Permalink to this definition"></a></dt>
<dd><p>sin is used to calculate the sine of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.sqrt">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#sqrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.sqrt" title="Permalink to this definition"></a></dt>
<dd><p>sqrt is used to calculate the square root of a column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.stddevPop">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">stddevPop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#stddevPop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.stddevPop" title="Permalink to this definition"></a></dt>
<dd><p>stddevPop is used to calculate the population standard deviation of a column.</p>
<blockquote>
<div><p>Example:</p>
</div></blockquote>
<blockquote>
<div><p>import fast_causal_inference.dataframe.functions as Fn
df = fast_causal_inference.readClickHouse(‘test_data_small’)
df.stddevPop(‘numerator’).show()
df.groupBy(‘treatment’).stddevPop(‘numerator’).show()
df.groupBy(‘treatment’).agg(Fn.stddevPop(‘numerator’).alias(‘numerator’)).show()
df.groupBy(‘treatment’).agg({‘numerator’:’stddevPop’, ‘numerator_pre’:’stddevPop’}).show()</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.stddevSamp">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">stddevSamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#stddevSamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.stddevSamp" title="Permalink to this definition"></a></dt>
<dd><p>stddevSamp is used to calculate the sample standard deviation of a column.</p>
<section id="id13">
<h3>Example:<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">stddevSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">stddevSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">stddevSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;numerator&#39;</span><span class="p">:</span><span class="s1">&#39;stddevSamp&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">:</span><span class="s1">&#39;stddevSamp&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.sum">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.sum" title="Permalink to this definition"></a></dt>
<dd><p>sum is used to calculate the sum of a column.</p>
<section id="id14">
<h3>Example:<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.tan">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#tan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.tan" title="Permalink to this definition"></a></dt>
<dd><p>tan is used to calculate the tangent of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.tgamma">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">tgamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#tgamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.tgamma" title="Permalink to this definition"></a></dt>
<dd><p>tgamma is used to calculate the gamma function of column x.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">Fn</span><span class="o">.</span><span class="n">tgamma</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.varPop">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">varPop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#varPop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.varPop" title="Permalink to this definition"></a></dt>
<dd><p>varPop is used to calculate the population variance of a column.</p>
<section id="id15">
<h3>Example:<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">varPop</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">varPop</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">varPop</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;numerator&#39;</span><span class="p">:</span><span class="s1">&#39;varPop&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">:</span><span class="s1">&#39;varPop&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dataframe.functions.varSamp">
<span class="sig-prename descclassname"><span class="pre">dataframe.functions.</span></span><span class="sig-name descname"><span class="pre">varSamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/functions.html#varSamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.functions.varSamp" title="Permalink to this definition"></a></dt>
<dd><p>varSamp is used to calculate the sample variance of a column.</p>
<section id="id16">
<h3>Example:<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.functions</span> <span class="k">as</span> <span class="nn">Fn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">varSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">Fn</span><span class="o">.</span><span class="n">varSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">varSamp</span><span class="p">(</span><span class="s1">&#39;numerator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;numerator&#39;</span><span class="p">:</span><span class="s1">&#39;varSamp&#39;</span><span class="p">,</span> <span class="s1">&#39;numerator_pre&#39;</span><span class="p">:</span><span class="s1">&#39;varSamp&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

</section>
<section id="features">
<h2>features<a class="headerlink" href="#features" title="Permalink to this heading"></a></h2>
<span class="target" id="module-dataframe.features"><span id="features-api"></span></span><dl class="py class">
<dt class="sig sig-object py" id="dataframe.features.Bucketizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dataframe.features.</span></span><span class="sig-name descname"><span class="pre">Bucketizer</span></span><a class="reference internal" href="_modules/dataframe/features.html#Bucketizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.features.Bucketizer" title="Permalink to this definition"></a></dt>
<dd><p>This class is used for bucketizing continuous variables into discrete bins.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dataframe.features.Bucketizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputCols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitsArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputCols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataframe/features.html#Bucketizer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.features.Bucketizer.fit" title="Permalink to this definition"></a></dt>
<dd><p>This function applies the bucketizing transformation to the specified columns of the input dataframe.</p>
<p>Parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<a class="reference internal" href="#dataframe.dataframe.DataFrame" title="dataframe.dataframe.DataFrame"><em>DataFrame</em></a>) – The input dataframe to be transformed.</p></li>
<li><p><strong>inputCols</strong> (<em>list</em>) – A list of column names in the dataframe to be bucketized.</p></li>
<li><p><strong>splitsArray</strong> (<em>list</em>) – A list of lists, where each inner list contains the split points for bucketizing the corresponding column in inputCols.</p></li>
<li><p><strong>outputCols</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of output column names after bucketizing. If not provided, ‘_buckets’ will be appended to the original column names.</p></li>
<li><p><strong>if_string</strong> (<em>bool</em><em>, </em><em>optional</em>) – A flag indicating whether the bin values should be treated as strings. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed dataframe with bucketized columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dataframe.dataframe.DataFrame" title="dataframe.dataframe.DataFrame">DataFrame</a></p>
</dd>
</dl>
<section id="id17">
<h3>Example<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.features</span> <span class="k">as</span> <span class="nn">Features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bucketizer</span> <span class="o">=</span> <span class="n">Features</span><span class="o">.</span><span class="n">Bucketizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">bucketizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">],[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="n">if_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;x1_buckets&#39;</span><span class="p">,</span><span class="s1">&#39;x2_buckets&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">                    x1            x2 x1_buckets x2_buckets</span>
<span class="go">0  -0.131301907  -3.152383354          1          0</span>
<span class="go">1  -0.966931088  -0.427920835          1          0</span>
<span class="go">2   1.257744217  -2.050358546      [1,3)          0</span>
<span class="go">3  -0.777228042  -2.621604715          1          0</span>
<span class="go">4  -0.669571385   0.606404768          1      [0,2)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span> <span class="o">=</span> <span class="n">bucketizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">],[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="n">if_string</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_new</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;x1_buckets&#39;</span><span class="p">,</span><span class="s1">&#39;x2_buckets&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">            x1            x2 x1_buckets x2_buckets</span>
<span class="go">0  -0.131301907  -3.152383354          1          1</span>
<span class="go">1  -0.966931088  -0.427920835          1          1</span>
<span class="go">2   1.257744217  -2.050358546          2          1</span>
<span class="go">3  -0.777228042  -2.621604715          1          1</span>
<span class="go">4  -0.669571385   0.606404768          1          2</span>
</pre></div>
</div>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dataframe.features.OneHotEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dataframe.features.</span></span><span class="sig-name descname"><span class="pre">OneHotEncoder</span></span><a class="reference internal" href="_modules/dataframe/features.html#OneHotEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dataframe.features.OneHotEncoder" title="Permalink to this definition"></a></dt>
<dd><p>This class implements the OneHotEncoder method for causal inference.</p>
<section id="id18">
<h3>Parameters<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>cols<span class="classifier">list, default=None</span></dt><dd><p>The columns to be one-hot encoded.</p>
</dd>
</dl>
</section>
<section id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>fit(dataframe):</dt><dd><p>Apply the OneHotEncoder method to the input dataframe.</p>
</dd>
</dl>
</section>
<section id="id19">
<h3>Example<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fast_causal_inference</span>
<span class="kn">import</span> <span class="nn">fast_causal_inference.dataframe.features</span> <span class="k">as</span> <span class="nn">Features</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fast_causal_inference</span><span class="o">.</span><span class="n">readClickHouse</span><span class="p">(</span><span class="s1">&#39;test_data_small&#39;</span><span class="p">)</span>
<span class="n">one_hot</span> <span class="o">=</span> <span class="n">Features</span><span class="o">.</span><span class="n">OneHotEncoder</span><span class="p">()</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">one_hot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x_cat1&#39;</span><span class="p">])</span>
<span class="n">df_new</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dataframe/dataframe.readStarRocks.html" class="btn btn-neutral float-left" title="dataframe.readStarRocks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="inference.html" class="btn btn-neutral float-right" title="Causal Inference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Tencent.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>